<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RetailBuddy - Dashboard</title>
  
  <!-- Favicon -->
  <%= favicon_link_tag 'retail_icon.png', type: 'image/png' %>
  <%= javascript_importmap_tags %>
  <%= turbo_include_tags %>

  <!-- CSS -->
  <%= stylesheet_link_tag "dashboard", media: "all", "data-turbo-track": "reload" %>
  <%= stylesheet_link_tag "custom", media: "all", "data-turbo-track": "reload" %>

  <!-- Font Awesome & Google Fonts -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <div id="dashboard-container">
    <div class="background-shapes">
      <div class="shape"></div>
      <div class="shape"></div>
      <div class="shape"></div>
      <div class="shape"></div>
    </div>
    
    <header class="header">
      <div class="logo-container">
        <div class="logo">
          <i class="fas fa-shopping-bag"></i>
          <span>RetailBuddy</span>
        </div>
      </div>
      
      <!-- Header Controls -->
      <div class="header-controls">
        <!-- Dark Mode Toggle Button -->
        <button class="theme-toggle" id="themeToggle">
          <i class="fas fa-sun"></i>
        </button>

        <!-- User Menu -->
        <div class="user-menu">
          <button class="user-button" id="userButton">
            <i class="fas fa-user-circle"></i>
            <span>Welcome, User</span>
            <i class="fas fa-chevron-down"></i>
          </button>

          <div class="user-dropdown" id="userDropdown">
            <%= button_to "Logout", logout_path, 
                          method: :delete, 
                          class: "dropdown-item",
                          form: { 
                            "data-turbo": "false",
                            "data-controller": "logout" 
                          } %>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="dashboard-content">
      <!-- Welcome Banner -->
      <section class="welcome-banner">
        <h1>Welcome to Retail Buddy</h1>
        <p>Your complete retail management solution. Choose from the options below to get started.</p>
      </section>

      <!-- Tile Grid -->
      <section class="tile-grid">
        <!-- Billing Tile -->
        <div class="tile fade-in-up">
          <i class="fas fa-file-invoice-dollar tile-icon"></i>
          <h3>Billing</h3>
          <p>Manage invoices, process payments, and track your sales</p>
        </div>

        <!-- Inventory Management Tile -->
        <div class="tile fade-in-up">
          <i class="fas fa-boxes tile-icon"></i>
          <h3>Inventory Management</h3>
          <p>Track stock levels, manage products, and handle suppliers</p>
        </div>

        <!-- Reports & Analytics Tile -->
        <div class="tile fade-in-up">
          <i class="fas fa-chart-line tile-icon"></i>
          <h3>Reports & Analytics</h3>
          <p>Get insights with detailed reports and visual analytics</p>
        </div>

        <!-- Customers Tile -->
        <div class="tile fade-in-up">
          <i class="fas fa-users tile-icon"></i>
          <h3>Customers</h3>
          <p>Manage customer data, loyalty programs, and engagement</p>
        </div>

        <!-- Help and Support Tile -->
        <div class="tile fade-in-up">
          <i class="fas fa-headset tile-icon"></i>
          <h3>Help and Support</h3>
          <p>Access tutorials, FAQs, and customer support</p>
        </div>

        <% if session[:role] == "Admin" %>
          <!-- Admin Panel Tile -->
          <div class="tile fade-in-up" id="adminTile">
            <i class="fas fa-user-shield tile-icon"></i>
            <h3>Admin Panel</h3>
            <p>Configure system settings and manage user permissions</p>
          </div>
        <% end %>
      </section>
    </main>
  </div>

  <%= javascript_include_tag "dashboard", "data-turbo-track": "reload", defer: true %>

  <!-- Fallback for Turbo -->
  <script>
    document.addEventListener("turbo:load", function() {
      // Initialize dropdown functionality
      const userButton = document.getElementById('userButton');
      const userDropdown = document.getElementById('userDropdown');
      
      if (userButton && userDropdown) {
        userButton.addEventListener('click', function(e) {
          e.stopPropagation();
          userDropdown.classList.toggle('show');
          
          // Update chevron icon
          const chevron = this.querySelector('.fa-chevron-down, .fa-chevron-up');
          if (chevron) {
            chevron.className = user
Your complete retail management solution. Choose from the options below to get started.ropdown.classList.contains('show') 
              ? 'fas fa-chevron-up' 
              : 'fas fa-chevron-down';
          }
        });

        // Close when clicking outside
        document.addEventListener('click', function() {
          if (userDropdown.classList.contains('show')) {
            userDropdown.classList.remove('show');
            const chevron = userButton.querySelector('.fa-chevron-up');
            if (chevron) chevron.className = 'fas fa-chevron-down';
          }
        });
      }
    });

    // Also initialize on regular page load
    document.addEventListener("DOMContentLoaded", function() {
      dispatchEvent(new Event("turbo:load"));
    });
  </script>
</body>
</html>